@model FESA.SCM.WebSite.Models.AssignmentModel
@{
    ViewData["Title"] = "DetailOT";
}

<script>
    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    })
</script>

@Html.Partial("_Menu")

<div id="dvworkOrders">
    @{Html.RenderPartial("_DetailWorkOrder", Model);}
</div>
<div class="modal fade" id="NewContact" tabindex="-1" role="dialog" aria-labelledby="NewContact" aria-hidden="true" style="padding-right: 17px;">
    <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 350px;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id=""></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form role="form" id="form_contact" method="POST">
                <div class="modal-body" style="display: block;">
                    <h4 style="font-weight: bold; margin-bottom: 1rem;">Nuevo contacto:</h4>

                    <div class="form-group">
                        <label for="Name" style="color: #7a7a7a;font-size: 14px;">NOMBRES</label>
                        <input type="text" class="form-control" id="NameContact" name="NameContact" aria-describedby="" placeholder="">
                    </div> <div class="form-group">
                        <label for="LastName" style="color: #7a7a7a;font-size: 14px;">APELLIDOS</label>
                        <input type="text" class="form-control" id="LastNameContact" name="LastNameContact" aria-describedby="" placeholder="">
                    </div>
                    <div class="form-group">
                        <label for="Email" style="color: #7a7a7a;font-size: 14px;">EMAIL</label>
                        <input type="email" class="form-control" id="EmailContact" name="EmailContact" aria-describedby="" placeholder="">
                    </div>
                    <div class="form-group">
                        <label for="Phone" style="color: #7a7a7a;font-size: 14px;">TELÉFONO</label>
                        <input type="text" class="form-control" id="PhoneContact" name="PhoneContact" aria-describedby="" placeholder="">
                    </div>

                </div>
                <div class="modal-footer" style="display: block;text-align: center;">
                    <button type="button" class="btn btn-default" data-dismiss="modal" style="margin: 0 12px;">Cancelar</button>
                    <button type="submit" class="btn btn-primary"  style="margin: 0 12px;">Guardar</button>

                </div>
              </form>
        </div>
    </div>
</div>

<script>
    
    $(document).ready(function () {
        $("#form_contact").on("submit", function (e) {
            e.preventDefault();
            ajax_form();
        });
    })
    function ajax_form() {
        var params = {
            AssignmentId: '@Model.Id',
            Name: $('#NameContact').val(),
            LastName: $('#LastNameContact').val(),
            Email: $('#EmailContact').val(),
            Phone: $('#PhoneContact').val(),
            IdCustomer :'@Model.WorkOrderId'
        };
        $.ajax({
            url: "/OT/SaveContact",
            method: "POST",
            data: params,
            async: true,
            success: function (response) {
                $('#NewContact').modal('hide');
                $('#dvTechnicalsContacts').html(response)
            },
            beforeSend: function () {
                $("body").fadeIn(function () {
                    $(".loader").show();
                });
            },
            complete: function () {
                $(".loader").hide();
            },
            error: function (xhr) {
                console.log(xhr.status + ": " + xhr.responseText);
            }
        });
    }
    </script>